---
title: CVE-2025-65512, CVE-2025-65513
author: P0LESTAR
date: 2025-12-13 00:01:01 +0800
categories: [CVE]
tags: [CVE, CVE-2025-65512, CVE-2025-65513, MCPì·¨ì•½ì ]
#pin: true
sitemap:
  changefreq: monthly
  priority: 0.5
---

> ìœ„ CVEëŠ” K-Shield Jr. í”„ë¡œì íŠ¸ì—ì„œ ë°œê²¬í•œ ì·¨ì•½ì ì…ë‹ˆë‹¤.
{: .prompt-info }

## URL
[CVE-2025-65512](https://www.cve.org/CVERecord?id=CVE-2025-65512), [CVE-2025-65513](https://www.cve.org/CVERecord?id=CVE-2025-65513)

- repository
<https://github.com/zcaceres/markdownify-mcp>

<https://github.com/zcaceres/fetch-mcp>

ê°™ì€ ê°œë°œìê°€ ë§Œë“  MCPì„œë²„ì—ì„œ ê°ê° CVEë¥¼ ë°œê¸‰ë°›ì•˜ìŠµë‹ˆë‹¤.

ë¹„ìŠ·í•œ ì·¨ì•½ì ì´ê¸° ë•Œë¬¸ì— í•œ í¬ìŠ¤íŠ¸ì— ê¸°ë¡í•©ë‹ˆë‹¤.

# CVE-2025-65512 (markdowify-mcp)

## Explain

ì‚¬ìš©ìê°€ ì œê³µí•œ URLì˜ ì›¹í˜ì´ì§€ë¥¼ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. 

ì„œë²„ì—ì„œ ì œê³µëœ URLë¡œ HTTP ìš”ì²­ì„ ìˆ˜í–‰í•˜ê³  ì‘ë‹µ(HTML)ì„ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

ì´ ë„êµ¬ì—ì„œ SSRF ì·¨ì•½ì ì„ ë°œê²¬í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.


## vulnerability

### Overview
- ì ì ˆí•œ URL ê²€ì¦ì´ë‚˜ hostname resolution ì—†ì´ fetch() í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì— ê³µê²©ìê°€ private ë„¤íŠ¸ì›Œí¬ì˜ ë‚´ë¶€ ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### Detail

> [src/server.ts](https://github.com/zcaceres/markdownify-mcp/blob/main/src/server.ts) line 55~62

```ts
const parsedUrl = new URL(validatedArgs.url);

if (!["http:", "https:"].includes(parsedUrl.protocol)) {
  throw new Error("Only http: and https: schemes are allowed.");
}

if (is_ip_private(parsedUrl.hostname)) {
  throw new Error(`Fetching ${validatedArgs.url} is potentially dangerous, aborting.`);
}
```
ìœ„ ì½”ë“œëŠ” http/https í”„ë¡œí† ì½œë¡œ ì‹œì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ê³ , `is_ip_private` í•¨ìˆ˜ë¡œ ë‚´ë¶€ip ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.

ë‘ ì¡°ê±´ì„ ë§Œì¡±í•˜ì§€ ëª»í•˜ë©´ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.

í•˜ì§€ë§Œ í™•ì¸í•´ë³´ë‹ˆ [is_ip_private](https://www.npmjs.com/package/private-ip)ëŠ” IPí˜•íƒœë§Œ í™•ì¸í• ë¿ ë„ë©”ì¸ì€ í™•ì¸í•˜ì§€ ëª»í•˜ëŠ” í•¨ìˆ˜ì˜€ìŠµë‹ˆë‹¤.

```
- `is_ip_private("127.0.0.1")` â†’ `true` ë°˜í™˜ (ì°¨ë‹¨âœ…)
- `is_ip_private("localhost")` â†’ `undefined` ë°˜í™˜ (ìš°íšŒğŸš¨)
```

![image](assets\img\cve-2025-65512.png)



## Remediation
- hostname resolutionì„ ì¶”ê°€í•©ë‹ˆë‹¤.

<br><br>

---

# CVE-2025-65513 (fetch-mcp)

## Explain
fetch-mcpì„œë²„ëŠ” HTML, JSON, ì¼ë°˜ í…ìŠ¤íŠ¸, ë§ˆí¬ë‹¤ìš´ ë“± ë‹¤ì–‘í•œ í˜•ì‹ìœ¼ë¡œ ì›¹ ì½˜í…ì¸ ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.


## vulnerability
>[src/Fetcher.ts](https://github.com/zcaceres/fetch-mcp/blob/main/src/Fetcher.ts) line 19~ 24

```ts
try {
  if (is_ip_private(url)) {
    throw new Error(
      `Fetcher blocked an attempt to fetch a private IP ${url}. This is to prevent a security vulnerability where a local MCP could fetch privileged local IPs and exfiltrate data.`,
    );
  }
```
ì´ ì½”ë“œë¥¼ ë³´ë©´ `CVE-2025-65512 markdownify`ì˜ ê·¸ ë¶€ë¶„ê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ì¡°ê¸ˆ ë‹¤ë¦…ë‹ˆë‹¤.

<br>

```ts
const parsedUrl = new URL(validatedArgs.url);

if (!["http:", "https:"].includes(parsedUrl.protocol)) {
  throw new Error("Only http: and https: schemes are allowed.");
}
is_ip_private(parsedUrl.hostname)


is_ip_private(url) -> urlíŒŒì‹± ì—†ë‹¤
```

ê·¸ë˜ì„œ urlì— ë‚´ë¶€IPë¥¼ í¬í•¨í•´ì„œ `https://127.0.0.1/api`ë¥¼ ì…ë ¥í•´ë„ `is_ip_private`ì€ `undefined`ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ìš°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.


> PoCì— ì‘ì„±í•˜ì§€ ì•Šì•˜ì—ˆëŠ”ë°, í”„ë¡œí† ì½œ ê²€ì¦ë„ ë¹ ì ¸ìˆê¸° ë•Œë¬¸ì— `ftp` ë“±ì„ ë„£ì–´ íŒŒì¼ì— ì ‘ê·¼í•  ìˆ˜ë„ ìˆì„ ê²ƒì´ë‹¤.
{: .prompt-info }

![image](assets\img\cve-2025-65513.png)


## Remediation

- URL íŒŒì‹± ë¡œì§ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
- í”„ë¡œí† ì½œ ê²€ì¦ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
- hostname resolutionì„ ì¶”ê°€í•©ë‹ˆë‹¤.